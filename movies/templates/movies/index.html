{% extends 'base.html' %}
{% load mathfilters %}
    
{% block body %}    
    <div class="main_section">
        <section class="box_office">
            <h3 class="section_header">일일 박스오피스 {{ date }} 기준</h3>
            <div class="movie_strip swiper-container">
                <div class="swiper-wrapper">
                    {% for list in daily_lists %}
                        <div class="movie_preview swiper-slide" data-toggle="modal" data-target="#exampleModalCenter" @click="currentMovie={{list}}">
                            <img src="{{ list.posterUrl }}">
                            <div class="movie_poster_bg"></div>
                            <span class="movie_preview_text movie_title">{{ list.movieNm }}</span>
                            <span class="movie_preview_text movie_year">{{ list.openDt | slice:"0:4" }}년</span>
                            <div class="movie_preview_text movie_score">
                                <div class="star-ratings-css">
                                    <div class="star-ratings-css-top" style="width: {{list.score | mul:10}}%">
                                        <span>★</span><span>★</span><span>★</span><span>★</span><span>★</span></div>
                                    <div class="star-ratings-css-bottom">
                                        <span>★</span><span>★</span><span>★</span><span>★</span><span>★</span></div>
                                </div>
                            </div>
                        </div>
                    {% endfor %}

                </div>
            </div>
        </section>
        <section class="recommendation">
            <h3 class="section_header">영화 추천<a href="{% url 'movies:movie_suggestions' %}"><button class="btn btn-crimson advanced_rec">추천 더보기</button></a></h3>
            
            <div class="movie_strip swiper-container2">
                <div class="swiper-wrapper">
                    {% for list in daily_lists %}
                        <div class="movie_preview swiper-slide" data-toggle="modal" data-target="#exampleModalCenter">
                            <img src="{{ list.posterUrl }}">
                            <div class="movie_poster_bg"></div>
                            <span class="movie_preview_text movie_title">{{ list.movieNm }}</span>
                            <span class="movie_preview_text movie_year">{{ list.openDt | slice:"0:4" }}년</span>
                            <div class="movie_preview_text movie_score">
                                <div class="star-ratings-css">
                                    <div class="star-ratings-css-top" style="width: calc({{ list.score }} * 10)%">
                                        <span>★</span><span>★</span><span>★</span><span>★</span><span>★</span></div>
                                    <div class="star-ratings-css-bottom">
                                        <span>★</span><span>★</span><span>★</span><span>★</span><span>★</span></div>
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                </div>
            </div>
            
        </section>
        <section class="recent_scores">
            <h3 class="section_header">최신 평점</h3>
        </section>
    </div>


    <!-- MODAL VUE.JS CURRENT MOVIE-->
    <div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog"
        aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-body modal_head">
                    <h3 class="movie_modal_title">[[ currentMovie.movieNm ]] ([[ currentMovie.openDt | getYear ]])</h3>
                    <div class="movie_modal_left">
                        <div class="movie_modal_score">
                            <div class="star-ratings-css">
                                <div class="star-ratings-css-top" :style="{'width': `${currentMovie.score*10}%`}">
                                    <span>★</span><span>★</span><span>★</span><span>★</span><span>★</span></div>
                                <div class="star-ratings-css-bottom">
                                    <span>★</span><span>★</span><span>★</span><span>★</span><span>★</span></div>
                            </div>
                            [[ currentMovie.score ]]점
                            <button class="btn btn-sm btn-crimson">Add to watchlist</button>
                        </div>
                    </div>
                </div>
                
                <div class="modal-body modal_content">
                    <div class="movie_modal_left">
                        <div class="movie_modal_stills">
                            <div id="carouselExampleFade" class="carousel slide carousel-fade" data-ride="carousel">
                              <div class="carousel-inner">
                                <div class="carousel-item" :class="{active: index === 0}" v-for="(item, index) in currentMovie.stillCuts">
                                  <img :src="item" class="d-block w-100 h-100">
                                </div>
                              </div>
                              <a class="carousel-control-prev" href="#carouselExampleFade" role="button" data-slide="prev">
                                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                                <span class="sr-only">Previous</span>
                              </a>
                              <a class="carousel-control-next" href="#carouselExampleFade" role="button" data-slide="next">
                                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                                <span class="sr-only">Next</span>
                              </a>
                            </div>
                        
                        </div>
                        <div class="movie_modal_trailer">
                            <iframe :src=`https://www.youtube.com/embed/${currentMovie.trailer}` frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                        </div>
                        <div class="movie_modal_text">
                            <div class="movie_modal_text_section">
                                <p>개요</p>
                                <p>[[currentMovie.openDt]] 개봉&nbsp;&nbsp;|&nbsp;&nbsp;<span v-for="nation in currentMovie.nations">[[ nation.nationNm ]],</span>&nbsp;&nbsp;|&nbsp;&nbsp;[[currentMovie.showTm]]분</p>
                            </div>
                            <div class="movie_modal_text_section">
                                <p>장르</p>
                                <p><span v-for="genre in currentMovie.genres">[[ genre.genreNm ]] | </span></p>
                            </div>
                            <div class="movie_modal_text_section">
                                <p>누적</p>
                                <p>[[ currentMovie.audiAcc ]]명</p>
                            </div>
                            <div class="movie_modal_text_section">
                                <p>감독</p>
                                <p><span v-for="director in currentMovie.directors">[[ director.peopleNm ]],</span></p>
                            </div>
                            <div class="movie_modal_text_section">
                                <p>출연</p>
                                <p><span v-for="actor in currentMovie.actors">[[ actor.peopleNm ]],</span></p>
                            </div>
                            <div class="movie_modal_text_section">
                                <p>줄거리</p>
                                <p>[[currentMovie.description]]</p>
                            </div>
                            
                            
                            
                            
                        </div>
                    </div>
                    <div class="movie_modal_right">
                        <h4>평점</h4>
                        <div class="score_form_outer">
                            <div class="star_rate">
                                <span class="rating">
                                    <input type="radio" class="rating-input"
                                            id="rating-input-1-5" name="rating-input-1" value=10 v-model="rating_score">
                                    <label for="rating-input-1-5" class="rating-star" title="10" @mouseover="scoreHoverOver(10)" @mouseleave="scoreHoverLeave()">★</label>
                                    
                                    <input type="radio" class="rating-input"
                                            id="rating-input-1-4" name="rating-input-1" value=8 v-model="rating_score">
                                    <label for="rating-input-1-4" class="rating-star" title="8" @mouseover="scoreHoverOver(8)" @mouseleave="scoreHoverLeave()">★</label>
                                    
                                    <input type="radio" class="rating-input"
                                            id="rating-input-1-3" name="rating-input-1" value=6 v-model="rating_score">
                                    <label for="rating-input-1-3" class="rating-star" title="6" @mouseover="scoreHoverOver(6)" @mouseleave="scoreHoverLeave()">★</label>
                                    
                                    <input type="radio" class="rating-input"
                                            id="rating-input-1-2" name="rating-input-1" value=4 v-model="rating_score">
                                    <label for="rating-input-1-2" class="rating-star" title="4" @mouseover="scoreHoverOver(4)" @mouseleave="scoreHoverLeave()">★</label>
                                    
                                    <input type="radio" class="rating-input"
                                            id="rating-input-1-1" name="rating-input-1" value=2 v-model="rating_score">
                                    <label for="rating-input-1-1" class="rating-star" title="2" @mouseover="scoreHoverOver(2)" @mouseleave="scoreHoverLeave()">★</label>
                                </span>
                            </div>
                            <div class="score_num">
                                <span v-if="scoreHover">[[ ratingScoreTmp ]]점</span>
                                <span v-else>[[ rating_score ]]점</span>
                            </div>
                            <input type="text" class="score_input">
                            <button class="btn btn-sm btn-crimson score_btn">등록</button>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>

    
{% endblock %}
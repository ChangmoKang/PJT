<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>KCM의 흑백영화</title>

    <!-- GOOGLE FONTS - NOTO SANS KR -->
    <link href="https://fonts.googleapis.com/css?family=Noto+Sans+KR" rel="stylesheet">

    <!-- FONT AWESOME -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css" integrity="sha384-oS3vJWv+0UjzBfQzYUhtDYW+Pj2yciDJxpsK1OYPAYjqT085Qq/1cq5FLXAZQ7Ay" crossorigin="anonymous">
    
    <!-- Link Swiper's CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/4.5.0/css/swiper.min.css">
    
    <!-- BOOTSTRAP CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

    <!-- BOOTSTRAP JS -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
        integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
        integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
        crossorigin="anonymous"></script>

    <!-- Swiper JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/4.5.0/js/swiper.min.js"></script>
    
    <!-- VUE.JS -->
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>

    <!-- AXIOS -->
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Noto Sans KR', sans-serif;
        }
        
        ::-webkit-scrollbar { 
            display: none; 
        }
        
        body {
            min-width: 360px;
            overflow-x: hidden;
        }
        
        #wrap {
            width: 100%;
            position: relative;
            background-color: #F6F6F8;
        }

        .btn-crimson {
            background-color: #C60021;
            border-color: #B2001D;
            color: #F6F6F8;
        }
        .btn-crimson:hover {
            background-color: #9E001A;
            border-color: #8A0017;
            color: #F6F6F8;
        }
        .btn-outline-crimson {
            border-color: #C60021;
            color: #C60021;
        }
        .btn-outline-crimson:hover {
            background-color: #C60021;
            border-color: #B2001D;
            color: #F6F6F8;
        }



        /* * * * * * * * *  SWIPER * * * * * * * * */
        
        .swiper-container, .swiper-container2 {
            width: 100%;
            /*padding-top: 50px;*/
            /*padding-bottom: 50px;*/
        }

        .swiper-slide {
            /*background-position: center;*/
            /*background-size: cover;*/
            /*width: 200px;*/
            /*height: 300px;*/
        }


        /* * * * * * * * *  NAVBAR * * * * * * * * */
        nav {
            position: fixed;
            top: 0;
            z-index: 999;
            width: 100%;
            height: 50px;
            line-height: 50px;
            background-color: #F6F6F8;
            color: #6C6C6C;
        }

        .nav_left {
            float: left;
            height: 100%;
        }

        .nav_right {
            float: right;
            height: 100%;
        }

        .nav_item {
            float: left;
            margin: 0 15px;
            color: #6C6C6C;
            font-weight: bold;
        }
        .nav_item:hover {
            /*color: #181818;*/
            color: #C60021;
            text-decoration: none;
        }

        .nav_home {
            width: 70px;
            height: 100%;
            position: relative;
            color: #6C6C6C;
        }
        .nav_home:hover {
            /*color: #181818;*/
            color: #C60021;
        }
        .nav_home > i {
            position: absolute;
            top: 10px;
            left: 8px;
        }
        .nav_home > span {
            position: absolute;
            font-size: 12px;
            top: 12px;
        }


        /* * * * * * * * *  MAIN SECTION * * * * * * * * */
        .main_section {
            margin-top: 50px;
            width: 100%;
            color: #C60021;
        }

        section {
            width: 100%;
            height: 430px;
            padding: 10px 0 20px;
            margin-bottom: 5px;
            background-color: #E3E3E3;
        }

        .section_header {
            width: 100%;
            height: 40px;
            line-height: 40px;
            padding: 0 20px;
            font-weight: bold;
            color: #C60021;
        }

        .movie_strip {
            width: 100%;
            height: calc(400px - 40px);
        }

        .movie_preview {
            width: 240px;
            height: calc(100% - 20px);
            box-shadow: 1px 1px 10px #181818;
            margin: 0 30px;
            position: relative;
            float: left;
        }

        .movie_preview > img {
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
        }

        .movie_poster_bg {
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
            background: linear-gradient(to top, rgba(0, 0, 0, 0.9), transparent 30%);
        }

        .movie_preview_text {
            position: absolute;
            color: #F6F6F8;
            z-index: 99;
            text-shadow: 1px 1px 0 #181818;
        }

        .movie_title {
            bottom: 35px;
            font-size: 18px;
            margin-left: 10px;
        }

        .movie_year {
            bottom: 10px;
            right: 10px;
        }

        .movie_score {
            bottom: 17px;
            /* width: 100px; */
            margin-left: 10px;
            font-family: 'Open Sans', sans-serif;
            /* overflow: hidden; */
        }


        /* * * * * * * * *  STAR RATING PERCENTAGE * * * * * * * * */

        @import url(https://fonts.googleapis.com/css?family=Open+Sans:400,600,700);

        .star-ratings-css {
            unicode-bidi: bidi-override;
            color: #E3E3E3;
            font-size: 18px;
            height: 18px;
            width: 90px; 
            position: relative;
            padding: 0;
            text-shadow: 0px 1px 0 #6C6C6C;
        }

        .star-ratings-css-top {
            color: #E3E3E3;
            color: #FA534F;
            padding: 0;
            position: absolute;
            z-index: 1;
            display: block;
            top: 0;
            left: 0;
            overflow: hidden;
        }

        .star-ratings-css-bottom {
            padding: 0;
            display: block;
            z-index: 0;
        }


        .advanced_rec {
            float: right;
        }


        /* * * * * * * * *  MODAL * * * * * * * * */
        .modal-content {
            background-color: #F6F6F8;
            color: #181818;
        }
        .modal_head {
            padding-bottom: 0;
        }
        
        .movie_modal_title {
            letter-spacing: 1px;
        }
        
        .modal-body {
            /*height: 500px;*/
            /*overflow-y: auto;*/
        }
        
        .movie_modal_left {
            width: 50%;
            float: left;
            padding-right: 10px;
            overflow: hidden;
        }
        .movie_modal_right {
            width: 50%;
            float: right;
            padding-left: 10px;
            overflow: hidden;
        }
        
        @media screen and (max-width: 992px) {
            .movie_modal_left, .movie_modal_right {
                width: 100%;
                float: none;
                padding: 0;
            }
            .movie_modal_left {
                padding-bottom: 10px;
            }
            .movie_modal_right {
                padding-top: 30px;
                border-top: 1px solid #E3E3E3;
            }
        }
        
        .movie_modal_score {
            height: 35px;
            line-height: 35px;
            margin-top: 10px;
        }
        .movie_modal_score .star-ratings-css {
            width: 90px;
            float: left;
            margin-right: 5px;
        }
        .movie_modal_score button {
            float: right;
        }
        
        .modal_content {
            height: calc(100vh - 160px);
            overflow-y: auto;
        }
        
        .movie_modal_stills {
            width: 100%;
            height: 200px;
            position: relative;
            overflow: hidden;
        }
        
        .movie_modal_trailer {
            width: 100%;
            height: 200px;
            margin-top: 20px;
        }
        .movie_modal_trailer > iframe {
            width: 100%; height: 100%;
        }
        
        .movie_modal_text {
            margin-top: 20px;
            border-top: 1px solid #E3E3E3;
            padding-top: 20px;
            width: 100%;
        }
        
        .movie_modal_text_section {
            width: 100%;
            color: #181818;
            overflow: hidden;
        }
        .movie_modal_text_section p:first-child {
            width: 55px;
            font-weight: bold;
            color: #C60021;
            font-size: 16px;
            float: left;
        }
        .movie_modal_text_section p:last-child {
            float: right;
            width: calc(100% - 55px);
            overflow: hidden;
        }


        /* * * * * * * * *  SCORE FORM (MODAL) * * * * * * * * */
        .score_form_outer {
            width: 100%;
            height: 35px;
        }

        .star_rate {
            width: 83px;
            height: 32px;
            float: left;
        }
        .rating {
            overflow: hidden;
            display: inline-block;
        }
        .rating-input {
            float: right;
            margin: 0 0 0 -16px;
            opacity: 0;
        }
        .rating-star {
            cursor: pointer;
            position: relative;
            display: block;
            width: 16px;
            font-size: 16px;
            height: 16px;
            color: #E3E3E3;
            float: right;
        }

        .rating:hover .rating-star:hover, 
        .rating:hover .rating-star:hover ~ .rating-star,
        .rating-input:checked ~ .rating-star {
            color: #FA534F;
        }

        .rating:hover .rating-star {
            color: #E3E3E3;
        }

        .score_input {
            float: left;
            width: calc(100% - 83px - 110px);
            height: 30px;
            margin-left: 10px;
            border: 1px solid #E3E3E3;
            border-radius: 3px;
        }
        .score_input:focus {
            outline-color: #C60021;
        }

        .score_btn {
            float: left;
            margin-left: 10px;
        }
        .score_num {
            float: left;
            width: 30px;
            margin-left: 5px;
            line-height: 27px;
            font-size: 14px;
        }



        /* * * * * * * * *  RECENT REVIEWS * * * * * * * * */
        
        .recent_scores {
            height: 330px;
            overflow: hidden;
        }
        .reviewCard {
            margin-top: 20px;
            margin-bottom: 50px;
            width: 100%;
            height: 200px;
            border-radius: 10px;
            background-color: #F6F6F8;
            padding: 20px;
            overflow-y: auto;
        }
        .reviewContent {
            color: #181818;
            margin-top: 10px;
        }
        .reviewMovieTitle {
            color: #6C6C6C;
            font-size: 14px;
            margin-top: 10px;
        }
        
        



        /* * * * * * * * *  FOOTER * * * * * * * * */
        footer {
            width: 100%;
            height: 150px;
            background-color: #630010;
            color: #F6F6F8;
            padding: 20px;
        }
        footer p {
            margin: 0;
            font-size: 14px;
        }
        
        
        
        
        
        
        /* * * * * * * * *  SUGGESTIONS PAGE * * * * * * * * */
        
        #suggMainContainer {
            margin-top: 50px;
            width: 100%;
            height: calc(100vh - 100px);
            padding: 20px;
            overflow-y: auto;
            background-color: #E3E3E3;
        }

        .optionSelectBox {
            margin: 10px auto;
            width: 550px;
            height: 160px;
        }
        .genreSelectMenu {
            width: 400px;
            float: left;
        }
        .genreCheckbox, .nationCheckbox {
            width: 100px;
            height: 40px; line-height: 36px;
            font-weight: bold;
            text-align: center;
            color: #F6F6F8;
            background: linear-gradient(to bottom, #C60021, rgb(95, 0, 16));
            border: 3px outset #C60021;
            border-radius: 5px;
        }
        .genreCheckbox:hover, .nationCheckbox:hover {
            background: #C60021;
        }
        #genreCB, #nationCB {
            display: none;
        }
        #genreCB:checked ~ .genreOptions,
        #nationCB:checked ~ .nationOptions {
            display: block;
        }
        .genreOptions, .nationOptions {
            width: 100%;
            display: none;
        }
        .genreOption {
            display: inline-block;
            padding: 2px 10px;
            margin: 2px 3px;
            border-radius: 10px;
            border: 2px solid #C60021;
            color: #181818;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
        }
        .selectedGenre {
            background: linear-gradient(to bottom, #C60021, rgb(95, 0, 16));;
            color: #F6F6F8;
        }

        .nationSelectMenu {
            width: 130px;
            margin-left: 20px;
            float: left;
        }
        .nationRadio {
            font-weight: bold;
            color: #C60021;
            font-size: 14px;
        }

        .suggResults {
            width: 100%;
            height: 300px;
            border: 1px solid royalblue;
        }
        
        .movieCardCont {
            width: 100%;
            height: 280px;
            border: 1px solid pink;
            position: relative;
        }
        .movieCard {
            width: 200px;
            height: calc(100% - 20px);
            border: 1px solid cyan;
            margin-bottom: 20px;
            position: absolute;
            top: 0; left: 50%;
            transform: translate(-50%);
        }
        
        .movieCardPoster {
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0; left: 0;
        }
        
        /* * * * * * * * *  FORMS * * * * * * * * */
        
        .formSection {
            width: 600px;
            margin: 50px auto;
            padding-top: 40px;
        }
        
        
    </style>
</head>

<body>
    <div id="wrap">
        <nav>
            <div class="nav_left">
                <a href="{% url 'movies:movie_index' %}">
                    <div class="nav_item nav_home">
                        <i class="fas fa-video"></i>
                        <span>HOME</span>
                    </div>
                </a>
            </div>
            <div class="nav_right">
                {% if request.user.is_authenticated %}
                    <a href="#" class="nav_item">찜한목록</a>
                    <a href="{% url 'accounts:logout' %}" class="nav_item">로그아웃</a>
                {% else %}
                    <a href="{% url 'accounts:login' %}" class="nav_item">로그인</a>
                    <a href="{% url 'accounts:signup' %}" class="nav_item">회원가입</a>
                {% endif %}
            </div>
        </nav>
        
        {% block body %}
        {% endblock %}

        <footer>
            <h4>KCM의 흑백영화</h4>
            <p>SSAFY 1기 서울 1반 최종 프로젝트 (2019년 5월)</p>
            <p>강창모: dkssudckdah@gmail.com</p>
            <p>윤지원: jiwonjulietyoon@gmail.com</p>
        </footer>

    </div>


    
    
    
    <script>
        
        const arrRemove = (arr, val) => {
            return arr.filter(function(el) {
                return el != val;
            });
        };
        
        
        const app = new Vue({
            delimiters: ['[[', ']]'],
            el: '#wrap',
            data: {
                rating_score: 0,
                ratingScoreTmp: '',
                ratingScoreContent: '',
                scoreHover: false,
                allMovies: [],
                currentMovie: '',
                allGenres: [],
                currentGenres: [],
                allNations: [],
                currentNations: [],
                allDirectors: [],
                currentDirectors: [],
                allActors: [],
                currentActors: [],
                allStills: [],
                currentStills: [],
                selectedGenres: [],
                suggNationOpt: 'all',
                allScores: [],
            },
            methods: {
                scoreHoverOver(num) {
                    this.scoreHover = true
                    this.ratingScoreTmp = num
                },
                scoreHoverLeave() {
                    this.scoreHover = false
                },
                genreSelectToggle(genre) {
                    if (genre.selected) {
                        genre.selected = false;
                        this.selectedGenres = arrRemove(this.selectedGenres, genre.id);
                    }
                    else {
                        genre.selected = true;
                        this.selectedGenres.push(genre.id);
                    }
                },
                getKoreaCode() {
                    let code = 0;
                    this.allNations.forEach((nation) => {
                        if (nation.nationNm == "한국") {
                            code = nation.id;
                        }
                    });
                    return code
                },
                getAllMovies() {
                    axios.get('https://final-prj-whitejcme.c9users.io/movies/get/')
                        .then((res) => {
                            this.allMovies = res.data
                        })
                },
                getAllGenres() {
                    axios.get('https://final-prj-whitejcme.c9users.io/movies/get/genres/')
                        .then((res) => {
                            this.allGenres = res.data
                        })
                },
                getAllNations() {
                    axios.get('https://final-prj-whitejcme.c9users.io/movies/get/nations/')
                        .then((res) => {
                            this.allNations = res.data
                        })
                },
                getAllDirectors() {
                    axios.get('https://final-prj-whitejcme.c9users.io/movies/get/directors/')
                        .then((res) => {
                            this.allDirectors = res.data
                        })
                },
                getAllStills() {
                    axios.get('https://final-prj-whitejcme.c9users.io/movies/get/stillCuts/')
                        .then((res) => {
                            this.allStills = res.data
                        })
                },
                getAllActors() {
                    axios.get('https://final-prj-whitejcme.c9users.io/movies/get/actors/')
                        .then((res) => {
                            this.allActors = res.data
                        })
                },
                setCurrentMovie(movie) {
                    this.currentMovie = movie;
                    this.currentGenres = this.allGenres.filter((item) => {
                        return movie.genre.includes(item.id)
                    });
                    this.currentNations = this.allNations.filter((item) => {
                        return movie.nation.includes(item.id)
                    });
                    this.currentDirectors = this.allDirectors.filter((item) => {
                        return movie.director.includes(item.id)
                    });
                    this.currentActors = this.allActors.filter((item) => {
                        return movie.actor.includes(item.id)
                    });
                    this.currentStills = this.allStills.filter((item) => {
                        return movie.stillCut.includes(item.id)
                    });
                },
                getAllScores() {
                    axios.get('https://final-pjt-dkssudckdah.c9users.io/movies/scores/')
                        .then((res) => {
                            this.allScores = res.data
                        });
                },
                createScoreReview() {
                    axios.post('https://final-pjt-dkssudckdah.c9users.io/movies/scores/', {
                        comment: this.ratingScoreContent,
                        score: this.rating_score,
                        movieCd: this.currentMovie.movieCd,
                    })
                },
            },
            filters: {
                getYear(value) {
                    if (!value) {
                        return ''
                    }
                    return value.slice(0, 4)
                },
            },
            computed: {
                suggestedMovies: function() {
                    let filteredByGenreMovies = this.allMovies.filter((movie) => {
                        return movie.genre.some(g => this.selectedGenres.includes(g));
                    });
                    
                    if (this.suggNationOpt == 'all') {
                        return filteredByGenreMovies
                    }
                    else if (this.suggNationOpt == "kor") {
                        return filteredByGenreMovies.filter((movie) => {
                            return movie.nation.some(g => g === this.getKoreaCode());
                        });
                    }
                    else {
                        return filteredByGenreMovies.filter((movie) => {
                            return movie.nation.every(g => g !== this.getKoreaCode());
                        });
                    }
                }
            },
            created: function () {
                this.getAllMovies();
                this.getAllGenres();
                this.getAllNations();
                this.getAllDirectors();
                this.getAllActors();
                this.getAllStills();
                this.getAllScores();
            }
        });
        
        var swiper = new Swiper('.swiper-container', {
            effect: 'coverflow',
            grabCursor: true,
            centeredSlides: true,
            slidesPerView: 'auto',
            coverflowEffect: {
                rotate: 50,
                stretch: 0,
                depth: 100,
                modifier: 1,
                slideShadows: true,
            },
        });
        
        var swiper2 = new Swiper('.swiper-container2', {
            effect: 'coverflow',
            grabCursor: true,
            centeredSlides: true,
            slidesPerView: 'auto',
            coverflowEffect: {
                rotate: 50,
                stretch: 0,
                depth: 100,
                modifier: 1,
                slideShadows: true,
            },
        });
        

        
    </script>
</body>

</html>